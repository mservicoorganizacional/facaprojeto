<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu com Tabulações</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="./style.css">
</head>
<body>
    <div id="background">
        <div id="background-color">
            <div id="menu-container">
                <ul>
                    <li>
                        <span class="menu-toggle" onclick="showTabs('menu1')">Identificação do Projeto</span>
                        <ul class="submenu">
                            <li onclick="openTab('tab1_1')">
                                <span class="status" id="status_tab1_1"></span><div></div>
                                Caracterização do Projeto</li>
                            <li onclick="openTab('tab1_2')">
                                <span class="status" id="status_tab1_2"></span><div></div>
                                Localização Geográfica</li>
                            <li onclick="openTab('tab1_3')">
                                <span class="status" id="status_tab1_3"></span><div></div>
                                Caracterização Ambiental</li>
                            <li onclick="openTab('tab1_4')">
                                <span class="status" id="status_tab1_4"></span><div></div>
                                Objeto do Projeto</li>
                            <li onclick="openTab('tab1_5')">
                                <span class="status" id="status_tab1_5"></span><div></div>
                                Esclarecimentos</li>
                        </ul>
                    </li>
                    <li>
                        <span class="menu-toggle" onclick="showTabs('menu2')">Coordenação do Projeto</span>
                        <ul class="submenu">
                            <li onclick="openTab('tab2_1')">
                                <span class="status" id="status_tab2_1"></span><div></div>
                                Coordenador</li>
                            <li onclick="openTab('tab2_2')">
                                <span class="status" id="status_tab2_2"></span><div></div>
                                Coordenador - Atividades</li>
                            <li onclick="openTab('tab2_3')">
                                <span class="status" id="status_tab2_3"></span><div></div>
                                Responsável Financeiro</li>
                            <li onclick="openTab('tab2_4')">
                                <span class="status" id="status_tab2_4"></span><div></div>
                                Resp. Fin. - Atividades</li>
                        </ul>
                    </li>
                    <li>
                        <span class="menu-toggle" onclick="showTabs('menu3')">Apresentação das Instituições Envolvidas</span>
                        <ul class="submenu">
                            <li onclick="openTab('tab3_1')">
                                <span class="status" id="status_tab3_1"></span><div></div>
                                Instituições Envolvidas</li>
                            <li onclick="openTab('tab3_2')">
                                <span class="status" id="status_tab3_2"></span><div></div>
                                Caracterização das Unidades Responsáveis</li>
                        </ul>
                    </li>
                    <li>
                        <span class="menu-toggle" onclick="showTabs('menu4')">Diagnóstico</span>
                        <ul class="submenu">
                            <li onclick="openTab('tab4_1')">
                                <span class="status" id="status_tab4_1"></span><div></div>
                                Histórico do Problema</li>
                            <li onclick="openTab('tab4_2')">
                                <span class="status" id="status_tab4_2"></span><div></div>
                                Situação Atual</li>
                        </ul>
                    </li>
                    <li>
                        <span class="menu-toggle" onclick="showTabs('menu5')">Justificativa</span>
                        <ul class="submenu">
                            <li onclick="openTab('tab5_1')">
                                <span class="status" id="status_tab5_1"></span><div></div>
                                Desenvolvimento do Projeto</li>
                            <li onclick="openTab('tab5_2')">
                                <span class="status" id="status_tab5_2"></span><div></div>
                                Envolvimento da Instituição no Projeto</li>
                        </ul>
                    </li>
                    <li>
                        <span class="menu-toggle" onclick="showTabs('menu6')">População Diretamente Envolvida</span>
                        <ul class="submenu">
                            <li onclick="openTab('tab6_1')">
                                <span class="status" id="status_tab6_1"></span>
                                <div>
                                    Identificação da População
                                </div>
                            </li>
                            <li onclick="openTab('tab6_2')">
                                <span class="status" id="status_tab6_2"></span>
                                <div>
                                    Participação e Apropriação dos Resultados
                                </div>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <span class="menu-toggle" onclick="showTabs('menu7')">Planejamento do Projeto</span>
                        <ul class="submenu">
                            <li onclick="openTab('tab7_1')">
                                <span class="status" id="status_tab7_1"></span><div></div>
                                Objetivo do Projeto</li>
                            <li onclick="openTab('tab7_2')">
                                <span class="status" id="status_tab7_2"></span><div></div>
                                Metas</li>
                            <li onclick="openTab('tab7_3')">
                                <span class="status" id="status_tab7_3"></span><div></div>
                                Atividades</li>
                            <li onclick="openTab('tab7_4')">
                                <span class="status" id="status_tab7_4"></span><div></div>
                                Riscos à Execução</li>
                            <li onclick="openTab('tab7_5')">
                                <span class="status" id="status_tab7_5"></span><div></div>
                                Resultados Esperados</li>
                            <li onclick="openTab('tab7_6')">
                                <span class="status" id="status_tab7_6"></span><div></div>
                                Estratégias de Continuidade</li>
                        </ul>
                    </li>
                    <li>
                        <span class="menu-toggle" onclick="showTabs('menu8')">Planejamento Orçamentário</span>
                        <ul class="submenu">
                            <li onclick="openTab('tab8_1')">
                                <span class="status" id="status_tab8_1"></span><div></div>
                                Itens de Despesa</li>
                            <li onclick="openTab('tab8_2')">
                                <span class="status" id="status_tab8_2"></span><div></div>
                                Detalhamento Orçamentário</li>
                            <li onclick="openTab('tab8_3')">
                                <span class="status" id="status_tab8_3"></span><div></div>
                                Insumos Declarados</li>
                            <li onclick="openTab('tab8_4')">
                                <span class="status" id="status_tab8_4"></span><div></div>
                                Cronograma de Execução Financeira</li>
                        </ul>
                    </li>
                    <li>
                        <span class="menu-toggle" onclick="showTabs('menu9')">Informações Complementares</span>
                        <ul class="submenu">
                            <li onclick="openTab('tab9_1')">
                                <span class="status" id="status_tab9_1"></span><div></div>
                                Equipe Técnica</li>
                            <li onclick="openTab('tab9_2')">
                                <span class="status" id="status_tab9_2"></span><div></div>
                                Curriculum Vitae</li>
                            <li onclick="openTab('tab9_3')">
                                <span class="status" id="status_tab9_3"></span><div></div>
                                Termos de Referência</li>
                            <li onclick="openTab('tab9_4')">
                                <span class="status" id="status_tab9_4"></span><div></div>
                                Obras e Instalações</li>
                            <li onclick="openTab('tab9_5')">
                                <span class="status" id="status_tab9_5"></span><div></div>
                                Equipamentos e Materiais Permanentes</li>
                        </ul>
                    </li>
                </ul>
            
            </div>
            <button type="button" id="sandwich-btn">&#9776;</button>
            <div id="submit-container">
                <input id="submit-button" type="button" onclick="getAllInputs()" value="Enviar">
            </div>
            <div id="content-container">
                <div id="menu1" class="tab-group">
                    <div class="tab-buttons">
                        <button class="tab-button active" onclick="openTab('tab1_1')">Caracterização do Projeto</button>
                        <button class="tab-button" onclick="openTab('tab1_2')">Localização Geográfica</button>
                        <button class="tab-button" onclick="openTab('tab1_3')">Caracterização Ambiental</button>
                        <button class="tab-button" onclick="openTab('tab1_4')">Objeto do Projeto</button>
                        <button class="tab-button" onclick="openTab('tab1_5')">Esclarecimentos</button>
                    </div>
                    <div id="tab1_1" class="tab-content active">
                        <h2>Caracterização do Projeto</h2>
                        <p>Conteúdo da aba "Caracterização do Projeto".</p>
                        <div class="row">
                            <div class="col-md-5">
                                <label>Titulo:</label><br>
                                <input type="text" id="titulo">
                                <br><br>
                                <label>Tipo de demanda:</label><br>
                                <label>
                                    <input type="radio" name="tipoDemanda" value="espontanea"> Espontânea
                                </label><br>
                                
                                <label>
                                    <input type="radio" name="tipoDemanda" value="induzida"> Induzida
                                </label><br>
                            </div>

                            <div class="col-md-7">
                                <label>Tipo de projeto:</label><br>
                                <label>
                                    <input type="radio" name="tipoProjeto" value="espontanea"> Novo Projeto
                                </label><br>
                                
                                <label>
                                    <input type="radio" name="tipoProjeto" value="induzida"> Complementação de projeto solicitada pelo FNMA
                                </label><br>
                            </div>
                                
                        </div>
                    </div>
                    <div id="tab1_2" class="tab-content">
                        <h2>Localização Geográfica</h2>
                        <p>Conteúdo da aba "Localização Geográfica".</p>
                        <div class="row">
                            <div class="col-md-5">
                                <label for="estado">UF:</label><br>
                                <select id="estado" name="estado">
                                    <option value="AC">Acre (AC)</option>
                                    <option value="AL">Alagoas (AL)</option>
                                    <option value="AP">Amapá (AP)</option>
                                    <option value="AM">Amazonas (AM)</option>
                                    <option value="BA">Bahia (BA)</option>
                                    <option value="CE">Ceará (CE)</option>
                                    <option value="DF">Distrito Federal (DF)</option>
                                    <option value="ES">Espírito Santo (ES)</option>
                                    <option value="GO">Goiás (GO)</option>
                                    <option value="MA">Maranhão (MA)</option>
                                    <option value="MT">Mato Grosso (MT)</option>
                                    <option value="MS">Mato Grosso do Sul (MS)</option>
                                    <option value="MG">Minas Gerais (MG)</option>
                                    <option value="PA">Pará (PA)</option>
                                    <option value="PB">Paraíba (PB)</option>
                                    <option value="PR">Paraná (PR)</option>
                                    <option value="PE">Pernambuco (PE)</option>
                                    <option value="PI">Piauí (PI)</option>
                                    <option value="RJ">Rio de Janeiro (RJ)</option>
                                    <option value="RN">Rio Grande do Norte (RN)</option>
                                    <option value="RS">Rio Grande do Sul (RS)</option>
                                    <option value="RO">Rondônia (RO)</option>
                                    <option value="RR">Roraima (RR)</option>
                                    <option value="SC">Santa Catarina (SC)</option>
                                    <option value="SP">São Paulo (SP)</option>
                                    <option value="SE">Sergipe (SE)</option>
                                    <option value="TO">Tocantins (TO)</option>
                                </select><br><br>
                                <label>Municipio:</label><br>
                                <input type="text" id="municipio">
                                <br>
                            </div>
                            <div class="col-md-7">
                                <label for="tipoAmbiente">Tipo ambiente:</label><br>
                                <select id="tipoAmbiente" name="tipoAmbiente">
                                    <option value="Rural">Rural</option>
                                    <option value="Urbano">Urbano</option>
                                    <option value="Área legalmente protegida">Área legalmente protegida</option>
                                    <option value="Corredor ecológico">Corredor ecológico</option>
                                    <option value="Águas costeiras ou marinhas">Águas costeiras ou marinhas</option>
                                    <option value="Áfuas fluviais ou lacustres">Áfuas fluviais ou lacustres</option>
                                    <option value="Áreas insulares (ilhas)">Áreas insulares (ilhas)</option>
                                </select><br><br>
                            </div>
                        </div>
                    </div>
                    <div id="tab1_3" class="tab-content">
                        <h2>Caracterização Ambiental</h2>
                        <p>Conteúdo da aba "Caracterização Ambiental".</p>
                        <label>Bioma: </label> <br>
                        <label><input type="checkbox" name="biome" value="amazonia"> Amazônia</label><br>
                        <label><input type="checkbox" name="biome" value="caatinga"> Caatinga</label><br>
                        <label><input type="checkbox" name="biome" value="campos"> Campos</label><br>
                        <label><input type="checkbox" name="biome" value="cerrado"> Cerrado</label><br>
                        <label><input type="checkbox" name="biome" value="mata_atlantica"> Mata Atlântica</label><br>
                        <label><input type="checkbox" name="biome" value="pantanal"> Pantanal</label><br>
                        <label><input type="checkbox" name="biome" value="zona_costeira_marinha"> Zona Costeira Marinha</label><br><br>
                    </div>
                    <div id="tab1_4" class="tab-content">
                        <h2>Objeto do Projeto</h2>
                        <p>Situação desejada que será obtida após a transformação da situação atual. O objeto 
                            deve ser escrito de forma resumida e pragmática, preferencialmente, em um único período. 
                            Exemplos: “Recuperação da área de preservação permanente às margens do córrego Aguado”; 
                            “Formação de educadores ambientais para atuação em áreas de agricultura familiar”; “Redução 
                            da emissão de gases de efeito estufa por atividade agropecuária em Cidadópolis”.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="projectResume" name="projectResume" rows="4" cols="50"></textarea><br>

                    </div>
                    <div id="tab1_5" class="tab-content">
                        <h2>Esclarecimentos</h2>
                        <p>Conteúdo da aba "Esclarecimentos".</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="esclarescimento" name="esclarescimento" rows="4" cols="50"></textarea><br>

                    </div>
                </div>

                <div id="menu2" class="tab-group" style="display:none;">
                    <div class="tab-buttons">
                        <button class="tab-button active" onclick="openTab('tab2_1')">Coordenador</button>
                        <button class="tab-button" onclick="openTab('tab2_2')">Coordenador - Atividades</button>
                        <button class="tab-button" onclick="openTab('tab2_3')">Responsável Financeiro</button>
                        <button class="tab-button" onclick="openTab('tab2_4')">Resp. Fin. - Atividades</button>
                    </div>
                    <div id="tab2_1" class="tab-content active">
                        <h2>Coordenador</h2>
                        <p>Conteúdo da aba "Coordenador".</p>
                        <div class="row">
                            <div class="col-md-5">

                                <label for="cpf">CPF:</label><br>
                                <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" maxlength="14"><br>
                                <label for="nomeCoordenador">Nome Coordenador:</label><br>
                                <input type="text" id="nomeCoordenador" name="nomeCoordenador"><br>
                                <label>O projeto foi elaborado pelo Coordenador?</label><br>
                                <label>
                                    <input type="radio" name="projCoorElab" value="sim"> Sim
                                </label>
                                <label>
                                    <input type="radio" name="projCoorElab" value="nao"> Não
                                </label><br>
                                
                            </div>
                            <div class="col-md-7">
                                <label>O Coordenador pertence ao quadro da instituição proponente?</label><br>
                                <label>
                                    <input type="radio" name="coorPertIns" value="sim"> Sim
                                </label>
                                <label>
                                    <input type="radio" name="coorPertIns" value="nao"> Não
                                </label><br>
                                
                                <label>Fonte pagadora</label><br>
                                <label>
                                    <input type="radio" name="fontPag" value="proponente"> Instituição Proponete
                                </label><br>
                                <label>
                                    <input type="radio" name="fontPag" value="parceira"> Instituição Parceira
                                </label><br>

                                <label for="contatoCoordenador">Contato Coordenador:</label><br>
                                <input type="text" id="contatoCoordenador" name="contatoCoordenador"><br>
                            </div>
                        </div>  
                    </div>
                    <div id="tab2_2" class="tab-content">
                        <h2>Coordenador - Atividades</h2>
                        <p>Resumo das atividades a serem desenvolvidas no projeto pelo coordenador:</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="ativCoordenador"></textarea><br>
                    </div>
                    <div id="tab2_3" class="tab-content">
                        <h2>Responsável Financeiro</h2>
                        <p>Conteúdo da aba "Responsável Financeiro".</p>
                        <div class="row">
                            <div class="col-md-5">

                                <label for="cpf">CPF:</label><br>
                                <input type="text" id="cpfResponsavelFin" name="cpf" placeholder="000.000.000-00" maxlength="14"><br>
                                <label for="nomeResponsavelFin">Nome Responsável financeiro:</label><br>
                                <input type="text" id="nomeResponsavelFin" name="nomeResponsavelFin"><br>
                                
                            </div>
                            <div class="col-md-7">
                                <label>O Responsável financeiro pertence ao quadro da instituição proponente?</label><br>
                                <label>
                                    <input type="radio" name="coorPertIns" value="sim"> Sim
                                </label>
                                <label>
                                    <input type="radio" name="coorPertIns" value="nao"> Não
                                </label><br>
                                
                                <label>Fonte pagadora</label><br>
                                <label>
                                    <input type="radio" name="fontPag" value="proponente"> Instituição Proponete
                                </label><br>
                                <label>
                                    <input type="radio" name="fontPag" value="parceira"> Instituição Parceira
                                </label><br>

                                <label for="contatoResponsavelFin">Contato Responsável financeiro:</label><br>
                                <input type="text" id="contatoResponsavelFin" name="contatoResponsavelFin"><br>
                            </div>
                        </div>  
                    </div>
                    <div id="tab2_4" class="tab-content">
                        <h2>Resp. Fin. - Atividades</h2>
                        <p>Conteúdo da aba "Resp. Fin. - Atividades".</p>
                        <p>Resumo das atividades a serem desenvolvidas no projeto pelo Responsável financeiro:</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="ativResponsavelFin"></textarea><br>
                    </div>
                </div>
                <div id="menu3" class="tab-group" style="display: none;">
                    <div class="tab-buttons">
                        <button class="tab-button" onclick="openTab('tab3_1')">Instituições Envolvidas</button>
                        <button class="tab-button" onclick="openTab('tab3_2')">Caracterização das Unidades Responsáveis</button>
                    </div>
                    <div id="tab3_1" class="tab-content">
                        <h2>Instituições Envolvidas</h2>
                        <p>Conteúdo sobre as instituições envolvidas.</p>
                        <div class="row">
                            <div class="col-md-5">
                                <label for="nomeInstituicao">Nome da Instituição do Projeto</label><br>
                                <input type="text" id="nomeInstituicao" name="nomeInstituicao"><br>
                                
                                <label for="siglaInstituicao">Sigla</label><br>
                                <input type="text" id="siglaInstituicao" name="siglaInstituicao"><br>
                                
                                <label for="cnpjInstituicao">CNPJ da Instituição do Projeto</label><br>
                                <input type="text" id="cnpjInstituicao" name="cnpjInstituicao"><br>
                                
                                <label>A Instituição participa neste projeto como:</label><br>
                                <label>
                                    <input type="radio" name="partInst" value="proponente"> Proponete   
                                </label>
                                <label>
                                    <input type="radio" name="partInst" value="parceira">    Parceira
                                </label><br>
                                <label>
                                    <input type="radio" name="partInst" value="parceira"> Interveniente
                                </label>
                                <label>
                                    <input type="radio" name="partInst" value="parceira"> Executora
                                </label><br>
                                
                                <label for="contatoInstituicao">Contato da Instituição do Projeto</label><br>
                                <input type="text" id="contatoInstituicao" name="contatoInstituicao"><br>
                                
                            </div>
                            <div class="col-md-7">
                                <label>Forma jurídica:</label><br>
                                <label>
                                    <input type="radio" name="formaJur" value="publica"> Pública
                                </label>
                                <label>
                                    <input type="radio" name="formaJur" value="privada"> Privada
                                </label><br>
                                
                                <label>Esfera:</label><br>
                                <label>
                                    <input type="radio" name="esferaJur" value="municipal"> Municipal
                                </label>
                                <label>
                                    <input type="radio" name="esferaJur" value="estadual"> Estadual
                                </label><br>
                                <label>
                                    <input type="radio" name="esferaJur" value="federal"> Federal
                                </label>
                                <label>
                                    <input type="radio" name="esferaJur" value="df"> Distrito Federal
                                </label><br>
                            </div>
                        </div>
                    </div>
                    <div id="tab3_2" class="tab-content">
                        <h2>Caracterização das Unidades Responsáveis</h2>
                        <textarea placeholder="Digite aqui seu texto ..." id="caracUnidadesResp"></textarea><br>
                    </div>
                </div>
            
                <!-- Grupo de abas para Diagnóstico -->
                <div id="menu4" class="tab-group" style="display: none;">
                    <div class="tab-buttons">
                        <button class="tab-button" onclick="openTab('tab4_1')">Histórico do Problema</button>
                        <button class="tab-button" onclick="openTab('tab4_2')">Situação Atual</button>
                    </div>
                    <div id="tab4_1" class="tab-content">
                        <h2>Histórico do Problema</h2>
                        <p>Histórico de problema da empresa</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="histProblema"></textarea><br>
                    </div>
                    <div id="tab4_2" class="tab-content">
                        <h2>Situação Atual</h2>
                        <p>Situação atual da empresa</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="situAtual"></textarea><br>
                    </div>
                </div>
            
                <!-- Grupo de abas para Justificativa -->
                <div id="menu5" class="tab-group" style="display: none;">
                    <div class="tab-buttons">
                        <button class="tab-button" onclick="openTab('tab5_1')">Desenvolvimento do Projeto</button>
                        <button class="tab-button" onclick="openTab('tab5_2')">Envolvimento da Instituição no Projeto</button>
                    </div>
                    <div id="tab5_1" class="tab-content">
                        <h2>Desenvolvimento do Projeto</h2>
                        <p>Justificativa para o desenvolvimento do projeto.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="justDesenv"></textarea><br>
                    </div>
                    <div id="tab5_2" class="tab-content">
                        <h2>Envolvimento da Instituição no Projeto</h2>
                        <p>Justificativa para o envolvimento da instituição no projeto.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="justEnv"></textarea><br>
                    </div>
                </div>
            
                <!-- Grupo de abas para População Diretamente Envolvida -->
                <div id="menu6" class="tab-group" style="display: none;">
                    <div class="tab-buttons">
                        <button class="tab-button" onclick="openTab('tab6_1')">Identificação da População</button>
                        <button class="tab-button" onclick="openTab('tab6_2')">Participação e Apropriação dos Resultados</button>
                    </div>
                    <div id="tab6_1" class="tab-content">
                        <h2>Identificação da População</h2>
                        <p>Categoria da população.</p>
                        <label for="tipoPopualacao">Tipo de população:</label><br>
                        <input type="text" id="tipoPopualacao" name="tipoPopualacao"><br>
                        <label for="qtdPessoas">Qtd. pessoas:</label><br>
                        <input type="text" id="qtdPessoas" name="qtdPessoas"><br>
                        <label for="qtdFamilias">Qtd. famílias:</label><br>
                        <input type="text" id="qtdFamilias" name="qtdFamilias"><br>
                        <label for="qtdMulheres">Qtd. mulheres:</label><br>
                        <input type="text" id="qtdMulheres" name="qtdMulheres"><br>
                        
                    </div>
                    <div id="tab6_2" class="tab-content">
                        <h2>Participação e Apropriação dos Resultados</h2>
                        <p>Participação dos beneficiários e apropriação dos resultados do projeto.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="partApropResult"></textarea><br>
                    </div>
                </div>
            
                <!-- Grupo de abas para Planejamento do Projeto -->
                <div id="menu7" class="tab-group" style="display: none;">
                    <div class="tab-buttons">
                        <button class="tab-button" onclick="openTab('tab7_1')">Objetivo do Projeto</button>
                        <button class="tab-button" onclick="openTab('tab7_2')">Metas</button>
                        <button class="tab-button" onclick="openTab('tab7_3')">Atividades</button>
                        <button class="tab-button" onclick="openTab('tab7_4')">Riscos à Execução</button>
                        <button class="tab-button" onclick="openTab('tab7_5')">Resultados Esperados</button>
                        <button class="tab-button" onclick="openTab('tab7_6')">Estratégias de Continuidade</button>
                    </div>
                    <div id="tab7_1" class="tab-content">
                        <h2>Objetivo do Projeto</h2>
                        <p>Conteúdo sobre o objetivo do projeto.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="objetivosProjeto"></textarea><br>
                    </div>
                    <div id="tab7_2" class="tab-content">
                        <h2>Metas</h2>
                        <p>Conteúdo sobre as metas do projeto.</p>
                        <table id="metasProjeto">
                            <tr>
                            <th>Meta</th>
                            <th>Etapa</th>
                            <th>Especificação</th>
                            <th>Unid</th>
                            <th>Quant</th>
                            <th>Início</th>
                            <th>Fim</th>
                            </tr>
                        </table>
                        <br>
                        <button onclick="addMetaRow()">Adicionar meta</button>
                        <button id="addEtapaRowButton" onclick="addEtapaRow()" disabled>Adicionar etapa</button>
                    </div>
                    <div id="tab7_3" class="tab-content">
                        <h2>Atividades</h2>
                        <p>Conteúdo sobre as atividades do projeto.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="atividadesProjeto"></textarea><br>
                    </div>
                    <div id="tab7_4" class="tab-content">
                        <h2>Riscos à Execução</h2>
                        <p>Conteúdo sobre os riscos à execução do projeto.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="riscosExecucao"></textarea><br>
                    </div>
                    <div id="tab7_5" class="tab-content">
                        <h2>Resultados Esperados</h2>
                        <p>Conteúdo sobre os resultados esperados do projeto.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="resultadosEsperados"></textarea><br>
                    </div>
                    <div id="tab7_6" class="tab-content">
                        <h2>Estratégias de Continuidade</h2>
                        <p>Conteúdo sobre as estratégias de continuidade do projeto.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="estrategiasContinuidade"></textarea><br>
                    </div>
                </div>
            
                <!-- Grupo de abas para Planejamento Orçamentário -->
                <div id="menu8" class="tab-group" style="display: none;">
                    <div class="tab-buttons">
                        <button class="tab-button" onclick="openTab('tab8_1')">Itens de Despesa</button>
                        <button class="tab-button" onclick="openTab('tab8_2')">Detalhamento Orçamentário</button>
                        <button class="tab-button" onclick="openTab('tab8_3')">Insumos Declarados</button>
                        <button class="tab-button" onclick="openTab('tab8_4')">Cronograma de Execução Financeira</button>
                    </div>
                    <div id="tab8_1" class="tab-content">
                        <h2>Itens de Despesa</h2>
                        <p>Conteúdo sobre os itens de despesa.</p>
                        <table id="dynamicTable">
                            <thead>
                                <tr>
                                <th>Denominação</th>
                                <th>Unidade</th>
                                <th>Valor unitário</th>
                                <th>Natureza</th>
                                <th>Elemento de despesa</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- As linhas serão adicionadas aqui -->
                            </tbody>
                        </table>
                        <br>
                        <button onclick="addRow()">Adicionar Linha</button>
                    </div>
                    <div id="tab8_2" class="tab-content">
                        <h2>Detalhamento Orçamentário</h2>
                        <p>Conteúdo sobre o detalhamento orçamentário.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="detalhamentoOrcamentario"></textarea><br>
                    </div>
                    <div id="tab8_3" class="tab-content">
                        <h2>Insumos Declarados</h2>
                        <p>Conteúdo sobre os insumos declarados. Para obter o código do insumo, consulte:</p>
                        <a href="https://www1.siop.planejamento.gov.br/mto/doku.php" target="_blank">
                            Insumos anuais
                        </a>
                        <br>
                        <br>
                        <table id="insumosDeclarados" style="border-collapse: collapse;">
                        </table>
                        <br>
                        <label for="metaEtapaSelect">Selecione uma Meta e Etapa:</label>
                        <select id="metaEtapaSelect" style="width: 20%;"></select>
                        <button id="addInsumeHeaderButton" onclick="addInsumeHeader()" disabled>Adicionar Meta</button>
                        <button id="addInsumeButton" onclick="addInsumeRow()" disabled>Adicionar Insumo</button>
                    </div>
                    <div id="tab8_4" class="tab-content">
                        <h2>Cronograma de Execução Financeira</h2>
                        <p>Conteúdo sobre o cronograma de execução financeira.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="cronogramaExec"></textarea><br>
                    </div>
                </div>
            
                <!-- Grupo de abas para Informações Complementares -->
                <div id="menu9" class="tab-group" style="display: none;">
                    <div class="tab-buttons">
                        <button class="tab-button" onclick="openTab('tab9_1')">Equipe Técnica</button>
                        <button class="tab-button" onclick="openTab('tab9_2')">Curriculum Vitae</button>
                        <button class="tab-button" onclick="openTab('tab9_3')">Termos de Referência</button>
                        <button class="tab-button" onclick="openTab('tab9_4')">Obras e Instalações</button>
                        <button class="tab-button" onclick="openTab('tab9_5')">Equipamentos e Materiais Permanentes</button>
                    </div>
                    <div id="tab9_1" class="tab-content">
                        <h2>Equipe Técnica</h2>
                        <p>Conteúdo sobre a equipe técnica.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="equipeTecnica"></textarea><br>
                    </div>
                    <div id="tab9_2" class="tab-content">
                        <h2>Curriculum Vitae</h2>
                        <p>Conteúdo sobre o curriculum vitae.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="curriculumVitae"></textarea><br>
                    </div>
                    <div id="tab9_3" class="tab-content">
                        <h2>Termos de Referência</h2>
                        <p>Conteúdo sobre os termos de referência.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="termosReferencia"></textarea><br>
                    </div>
                    <div id="tab9_4" class="tab-content">
                        <h2>Obras e Instalações</h2>
                        <p>Conteúdo sobre as obras e instalações.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="obrasInstalacoes"></textarea><br>
                    </div>
                    <div id="tab9_5" class="tab-content">
                        <h2>Equipamentos e Materiais Permanentes</h2>
                        <p>Conteúdo sobre os equipamentos e materiais permanentes.</p>
                        <textarea placeholder="Digite aqui seu texto ..." id="equipMatPerm"></textarea><br>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        function atualizarOpcoes() {
            const select = document.getElementById("metaEtapaSelect");
            select.innerHTML = ""; // Limpa as opções atuais

            const tabela = document.getElementById("metasProjeto");
            const linhas = tabela.getElementsByTagName("tr");
            var actualMeta ="1";
            let opcoes = new Set();
            for (let i = 1; i < linhas.length; i++) {
                if(linhas[i].children[0].innerHTML != "-"){
                    actualMeta = linhas[i].children[0].innerHTML;
                    continue;
                }
                // let meta = linhas[i].getElementsByTagName('td')[0].getElementsByTagName('input')[0].innerHTML;
                let etapa = linhas[i].children[1].innerHTML;
                let opcaoTexto = `Meta ${actualMeta} - Etapa ${etapa}`;
                opcoes.add(opcaoTexto);
            }
            
            opcoes.forEach(opcaoTexto => {
                let option = document.createElement("option");
                option.value = opcaoTexto;
                option.textContent = opcaoTexto;
                select.appendChild(option);
            });
            var addInsumeHeaderButton = document.getElementById("addInsumeHeaderButton");
            console.log(opcoes.size);
            if(opcoes.size > 0){
                addInsumeHeaderButton.disabled = false;
            }else{
                addInsumeHeaderButton.disabled = true;
            }
        }

        function CloseMenu(){
            const menu = document.getElementById('menu-container');
            if(screen.width < 786 ){
                if(menu.classList != 'hidden'){
                    menu.classList.toggle('hidden');
                }
            }else{
                if(menu.classList == 'hidden'){
                    menu.classList.toggle('hidden');
                }
            }
        }

        window.onresize = CloseMenu;

        document.querySelectorAll('.menu-toggle').forEach(function(toggle) {
            toggle.addEventListener('click', function() {
                this.classList.toggle('expanded');
            });
        });

        function ValidateTabEntries(componente){
            var campos = document.querySelectorAll('#'+componente.id+' input, #'+componente.id+' textarea, #'+componente.id+' select');            
            var todosPreenchidos = true;

            campos.forEach(function(campo) {
                if (campo.type === 'text' || campo.type === 'radio' || campo.type === 'checkbox' || campo.tagName.toLowerCase() === 'textarea') {
                    if (campo.type === 'text' && campo.value.trim() === "") {
                        todosPreenchidos = false;
                    }
                    if (campo.type === 'radio' && !campo.checked) {
                        var grupoRadio = document.querySelectorAll('input[name="' + campo.name + '"]');
                        var algumSelecionado = false;
                        grupoRadio.forEach(function(radio) {
                            if (radio.checked) {
                                algumSelecionado = true;
                            }
                        });
                        if (!algumSelecionado) {
                            todosPreenchidos = false;
                        }
                    }
                    if (campo.tagName.toLowerCase() === 'textarea' && campo.value.trim() === "") {
                        todosPreenchidos = false;
                    }

                    if (campo.type === 'checkbox') {
                        var grupoCheckbox = document.querySelectorAll('input[name="' + campo.name + '"]');
                        if (grupoCheckbox.length > 1) {
                            var algumMarcado = Array.from(grupoCheckbox).some(function(checkbox) {
                                return checkbox.checked;
                            });
                            if (!algumMarcado) {
                                todosPreenchidos = false;
                            }
                        } else if (!campo.checked) {
                            todosPreenchidos = false;
                        }
                    }
                }
            });
            var elementoStatus = document.getElementById('status_' + componente.id);
            if (todosPreenchidos) {
                elementoStatus.classList.add("filled");
            } else {
                elementoStatus.classList.remove("filled");
            }
        }

        document.querySelectorAll('input, textarea, select').forEach(function(entry){
            entry.addEventListener('change', function(componente) {
                let parente = componente.target.parentElement
                while (true){
                    if(parente.id.includes('tab')){
                        break
                    }
                    parente = parente.parentElement
                }
                ValidateTabEntries(parente);
            })
        })



        document.addEventListener('DOMContentLoaded', CloseMenu);

        const sandwichBtn = document.getElementById('sandwich-btn');
        const menu = document.getElementById('menu-container');
        const content = document.getElementById('content-container');

        // Função para alternar a visibilidade do menu
        sandwichBtn.addEventListener('click', () => {
            menu.classList.toggle('hidden');  // Alterna a classe 'visible' para mostrar/ocultar o menu
        });
        
        function showTabs(menuId) {
            // Ocultar todos os grupos de abas
            var tabGroups = document.querySelectorAll('.tab-group');
            tabGroups.forEach(function(group) {
                group.style.display = 'none';
            });

            // Mostrar o grupo de abas selecionado
            document.getElementById(menuId).style.display = 'block';

            // Abrir a primeira aba do grupo
            var firstTab = document.getElementById(menuId).querySelector('.tab-buttons .tab-button');
            if (firstTab) firstTab.click();
        }

        function openMenu(menuId) {
            // Oculta todos os grupos de abas
            document.querySelectorAll('.tab-group').forEach(group => {
                group.style.display = 'none';
            });
            // Mostra o grupo de abas correspondente
            document.getElementById(menuId).style.display = 'block';
            
            // Opcional: fecha todas as abas do grupo
            document.querySelectorAll(`#${menuId} .tab-content`).forEach(tab => {
                tab.style.display = 'none';
            });
        }

        function openTab(tabId) {
            showTabs("menu" + tabId[3]);
            
            // Ocultar todas as abas
            var tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(function(tab) {
                tab.classList.remove('active');
            });
            
            // Remover a classe 'active' de todos os botões
            var buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(function(button) {
                button.classList.remove('active');
            });
            
            // Mostrar a aba selecionada
            document.getElementById(tabId).classList.add('active');

            // Adicionar a classe 'active' ao botão correspondente
            var activeButton = document.querySelector('.tab-button[onclick="openTab(\'' + tabId + '\')"]');
            if (activeButton) activeButton.classList.add('active');
        }
        
        function addRow() {
            // Obtém o corpo da tabela
            const tableBody = document.getElementById('dynamicTable').querySelector('tbody');
            
            // Cria uma nova linha
            const newRow = document.createElement('tr');
            
            // Adiciona 3 células editáveis
            for (let i = 0; i < 5; i++) {
                const cell = document.createElement('td');
                const input = document.createElement('input');
                input.type = 'text';
                input.placeholder = `Digite aqui...`;
                cell.appendChild(input);
                newRow.appendChild(cell);
            }
            
            // Adiciona um botão para remover a linha
            const actionCell = document.createElement('td');
            const deleteButton = document.createElement('button');
            deleteButton.textContent = 'Remover';
            deleteButton.onclick = function() {
                tableBody.removeChild(newRow);
            };
            actionCell.appendChild(deleteButton);
            newRow.appendChild(actionCell);
            
            // Adiciona a nova linha ao corpo da tabela
            tableBody.appendChild(newRow);
        }

        function createInput(type){
            const input = document.createElement('input');
            input.type = type;
            return input;
        }

        function enableStepAdiction(){
            let stepButton = document.getElementById('addEtapaRowButton');
            if(metasCount > 1){
                stepButton.disabled = false;
            }else{
                stepButton.disabled = true;
            }
        }
        
        var metasCount = 1;
        
        function decreaseMetasNumber(number){
            const tableBody = document.getElementById('metasProjeto');
            const tableRows = tableBody.getElementsByTagName('tr');
            
            for(let i = 1; i < tableRows.length; i++){
                if(tableRows.item(i).firstChild.innerHTML != "-"){
                    if(parseInt(tableRows.item(i).firstChild.innerHTML) > parseInt(number)){
                        tableRows.item(i).firstChild.innerHTML = parseInt(tableRows.item(i).firstChild.innerHTML) - 1;
                    }
                }
            }
        }

        function removeStepsChilds(number){
            const tableBody = document.getElementById('metasProjeto');
            const tableRows = tableBody.getElementsByTagName('tr');
            
            let lengthTable = tableRows.length;
            for(let i = 1; i < tableRows.length; i++){
                if(tableRows.item(i).firstChild.innerHTML === number){
                    for(let j = i + 1; j < lengthTable; j++ ){
                        console.log(tableRows.item(j));
                        if(tableRows.item(j).firstChild.innerHTML === "-"){
                            tableBody.removeChild(tableRows.item(j));
                            j -= 1;
                            lengthTable -= 1;
                        }else{
                            return;
                        }
                    }
                }
            }
            atualizarOpcoes();
        }

        function addMetaRow(){
            // Obtém o corpo da tabela
            const tableBody = document.getElementById('metasProjeto');
            const tr = document.createElement("tr");
            const colunas= [
                document.createTextNode(metasCount),
                document.createTextNode("-"),
                createInput("text"),
                createInput("text"),
                createInput("text"),
                createInput("date"),
                createInput("date")
            ];
            colunas.forEach(texto => {
                const td = document.createElement("td");
                td.appendChild(texto);
                tr.appendChild(td);
            });

            // Adiciona um botão para remover a linha
            const actionCell = document.createElement('td');
            const deleteButton = document.createElement('button');
            deleteButton.textContent = 'Remover';
            deleteButton.onclick = function() {
                metasCount -= 1;
                removeStepsChilds(tr.firstChild.innerHTML);
                decreaseMetasNumber(tr.firstChild.innerHTML);
                tableBody.removeChild(tr);
                enableStepAdiction();
            };
            actionCell.appendChild(deleteButton);
            tr.appendChild(actionCell);
            metasCount += 1;
            enableStepAdiction();
            // Adiciona a nova linha ao corpo da tabela
            tableBody.appendChild(tr);
            atualizarOpcoes();
            // <tr>
            //     <td>Instrutor para as oficinas</td>
            //     <td>80 horas</td>
            //     <td>30,00</td>
            //     <td>0,00</td>
            //     <td>2.400,00</td>
            //     <td>339036</td>
            // </tr>

            // // Cria uma nova linha
            // const newRow = document.createElement('tr');
            
            // for (let i = 0; i < 2; i++) {
            //     const cell = document.createElement('td');
            //     const input = document.createElement('input');
            //     input.type = 'number';
            //     cell.appendChild(input);
            //     newRow.appendChild(cell);
            // }

            // for (let i = 0; i < 3; i++) {
            //     const cell = document.createElement('td');
            //     const input = document.createElement('input');
            //     input.type = 'text';
            //     input.placeholder = `Digite aqui...`;
            //     cell.appendChild(input);
            //     newRow.appendChild(cell);
            // }
            
            // for (let i = 0; i < 2 ; i++) {
            //     const cell = document.createElement('td');
            //     const input = document.createElement('input');
            //     input.type = 'date';
            //     cell.appendChild(input);
            //     newRow.appendChild(cell);
            // }


        }

        function getActualStep(){
            const lastStep = document.getElementById('metasProjeto').lastChild.childNodes[1].innerHTML;
            if (lastStep === "-"){
                return 1;
            }else{
                return parseInt(lastStep) + 1;
            }
        }

        function addEtapaRow(){
            // Obtém o corpo da tabela
            const tableBody = document.getElementById('metasProjeto');
            const tr = document.createElement("tr");
            const colunas= [
                document.createTextNode("-"),
                document.createTextNode(getActualStep()),
                createInput("text"),
                createInput("text"),
                createInput("text"),
                createInput("date"),
                createInput("date")
            ];
            colunas.forEach(texto => {
                const td = document.createElement("td");
                td.appendChild(texto);
                tr.appendChild(td);
            });

            // Adiciona um botão para remover a linha
            const actionCell = document.createElement('td');
            const deleteButton = document.createElement('button');
            deleteButton.textContent = 'Remover';
            deleteButton.onclick = function() {
                tableBody.removeChild(tr);
            };
            actionCell.appendChild(deleteButton);
            tr.appendChild(actionCell);
            // Adiciona a nova linha ao corpo da tabela
            tableBody.appendChild(tr);
            atualizarOpcoes();
        }

        function RemoveMetaCascade(className){
            var tableBody = document.getElementById('insumosDeclarados');
            var toDelete = tableBody.getElementsByClassName(className);
            
            for (var i = toDelete.length - 1; i >= 0; i--) {
                tableBody.removeChild(toDelete[i]);
            }

            if( tableBody.lastChild.className != undefined){
                actualInsumeClass = tableBody.lastChild.className;
            }else{
                actualInsumeClass = "class-0";
                var addInsumeButton = document.getElementById("addInsumeButton");
                addInsumeButton.disabled = true;
            }
        }

        function addInsumeTitleRow(name, description){
            const cell = document.createElement('tr');
            const th1 = document.createElement('th');
            th1.colSpan = 1;
            th1.innerHTML = name;
            const th2 = document.createElement('th');
            th2.colSpan = 5;
            th2.innerHTML = description;

            cell.appendChild(th1);
            cell.appendChild(th2);
            
            cell.className = actualInsumeClass;
            return cell;
        }

        function CreateSelectToCodDespesa(){
            var select = document.createElement("select");
            for (var i = 0; i < array.length; i++) {
                var option = document.createElement("option");
                option.value = array[i];
                option.text = array[i];
                select.appendChild(option);
            }
        }

        var actualInsumeClass = "class-0";

        function addInsumeRow(){
            const tableBody = document.getElementById('insumosDeclarados');
           
            let newRow = document.createElement('tr');
            colunas = [
                createInput("text"),
                createInput("text"),
                createInput("number"),
                createInput("number"),
                createInput("number"),
                createInput("number"),
                ];

            colunas.forEach(texto => {
                const td = document.createElement("td");
                td.appendChild(texto);
                newRow.appendChild(td);
            });

            // Adiciona um botão para remover a linha
            const actionCell = document.createElement('td');
            const deleteButton = document.createElement('button');
            deleteButton.textContent = 'Remover';
            deleteButton.onclick = function() {
                tableBody.removeChild(newRow);
            };
            actionCell.appendChild(deleteButton);
            newRow.appendChild(actionCell);
            
            newRow.className = actualInsumeClass;
            // Adiciona a nova linha ao corpo da tabela
            tableBody.appendChild(newRow);
        }

        function addInsumeHeader(){
            
            
            // Obtém o corpo da tabela
            const tableBody = document.getElementById('insumosDeclarados');
            const stepButton = document.getElementById('metaEtapaSelect');
            const tabela = document.getElementById("metasProjeto");
            const linhas = tabela.getElementsByTagName("tr");
            
            var metaText;
            var stepText;
            const metaSelected = metaEtapaSelect.value.substring(5, metaEtapaSelect.value.indexOf("- Etapa ") - 1);
            const stepSelected = metaEtapaSelect.value.substring(8 + metaEtapaSelect.value.indexOf("- Etapa "));
            
            actualInsumeClass = "classMeta-"+ parseInt(metaSelected) + "_" + parseInt(stepSelected); 

            for (let i = 1; i < linhas.length; i++) {
                if(linhas[i].children[0].innerHTML === metaSelected){
                    metaText = linhas[i].children[2].children[0].value;
                    for (let j = i + 1; j < linhas.length; j++) {
                        console.log(linhas[j].children[2].children[0].value);
                        if(linhas[j].children[1].innerHTML === stepSelected){
                            stepText = linhas[j].children[2].children[0].value;
                            break;
                        }
                    }
                }
            }

            // Cria uma nova linha
            var newMeta = addInsumeTitleRow("Meta " + metaSelected, metaText);
            
            // Adiciona um botão para remover a linha
            var actionCell = document.createElement('td');
            var deleteButton = document.createElement('button');
            deleteButton.textContent = 'Remover';
            deleteButton.onclick = function() {
                RemoveMetaCascade(newMeta.classList);
            };
            actionCell.appendChild(deleteButton);
            newMeta.appendChild(actionCell);

            newMeta.className = actualInsumeClass;
            tableBody.appendChild(newMeta);
                        
            tableBody.appendChild(addInsumeTitleRow("Etapa " + stepSelected, stepText));
            
            let newRow = document.createElement('tr');
            colunas = [
                document.createTextNode("Insumo"),
                document.createTextNode("Quantidade"),
                document.createTextNode("Valor unitário (R$)"),
                document.createTextNode("FNMA (R$)"),
                document.createTextNode("Contrapartida (R$)"),
                document.createTextNode("Código de despesa")
                ]
            colunas.forEach(texto => {
                const td = document.createElement("th");
                td.appendChild(texto);
                newRow.appendChild(td);
            });
            
            newRow.className = actualInsumeClass;
            tableBody.appendChild(newRow);
            
            newRow = document.createElement('tr');
            colunas = [
                createInput("text"),
                createInput("text"),
                createInput("number"),
                createInput("number"),
                createInput("number"),
                createInput("number"),
                ];

            colunas.forEach(texto => {
                const td = document.createElement("td");
                td.appendChild(texto);
                newRow.appendChild(td);
            });

            // Adiciona um botão para remover a linha
            actionCell = document.createElement('td');
            deleteButton = document.createElement('button');
            deleteButton.textContent = 'Remover';
            deleteButton.onclick = function() {
                tableBody.removeChild(newRow);
            };
            actionCell.appendChild(deleteButton);
            newRow.appendChild(actionCell);
            
            // Adiciona a nova linha ao corpo da tabela
            newRow.className = actualInsumeClass;
            tableBody.appendChild(newRow);
            var addInsumeButton = document.getElementById("addInsumeButton");
            addInsumeButton.disabled = false;
        }

        function PrintSplitedText(aux){

            splitedString = aux.split(':');
            linhas = doc.splitTextToSize(aux.replace('\n',''), 170);
            alturaTexto = linhas.length * alturaLinha;

            if (linhas.length > 1){
                if(size + alturaTexto + fatorConversao * fontSize + (linhas.length - 1) * fontSize * 0.15 >= 297){
                    doc.addPage();
                    size = 20;
                }
            }
            else{
                if(size + alturaTexto + fatorConversao * fontSize >= 297){
                    doc.addPage();
                    size = 20;
                }
            }

            doc.setFont("Helvetica", "bold");
            
            doc.text(splitedString[0] + ": ", 20, size, { maxWidth: 170 })
            
            doc.setFont("Helvetica", "normal");
            doc.text("  " + splitedString[1], 20 + doc.getTextWidth(splitedString[0] + ": "), size, { maxWidth: 170 })
        
            if (linhas.length > 1){
                size += alturaTexto + fatorConversao * fontSize + (linhas.length - 1) * fontSize * 0.15;
            }else{
                size += alturaTexto + fatorConversao * fontSize ;
            }
        }

        const { jsPDF } = window.jspdf;
        var doc = new jsPDF();
        
        var fontSize = 20; // Tamanho da fonte em pontos
        const fatorConversao = 0.3528; // 1 ponto ≈ 0.3528 mm
        const alturaLinha = fontSize * fatorConversao;
        var alturaTexto = 0; 
        var linhas = 0;
        var splitedString = 0;
        var size = 20;

        function getAllInputs() {
                
            // Seleciona todos os elementos de entrada no formulário
            const inputs = document.querySelectorAll('input:not([type="button"]):not([type="radio"]):not([type="checkbox"]), input[type="radio"]:checked, textarea, select, input[type="checkbox"]:checked');
            
            let contratoFinal = "";
        
            fetch(window.location.href + "documento.txt")
                .then(response => response.text())
                .then(text => {
                    contratoFinal = text;
                    inputs.forEach(input => {
                        if(input.value != ""){
                            if(input.id != ""){
                                contratoFinal = contratoFinal.replaceAll('{{'+input.id+'}}', input.value);
                            }else{
                                contratoFinal = contratoFinal.replaceAll('{{'+input.name+'}}', input.value);
                            }
                        }
                    });
                var table = document.getElementById("dynamicTable");
                var rows = table.getElementsByTagName('tr');
                var data = [];


                // Percorre cada linha da tabela (excluindo o cabeçalho)
                for (let i = 1; i < rows.length; i++) {
                    const cells = rows[i].getElementsByTagName('td');
                    const rowData = {
                        denominacao: cells[0].getElementsByTagName('input')[0].value,
                        unidade: cells[1].getElementsByTagName('input')[0].value,
                        valorUnitario: cells[2].getElementsByTagName('input')[0].value,
                        natureza: cells[3].getElementsByTagName('input')[0].value,
                        elementoDespesa: cells[4].getElementsByTagName('input')[0].value
                    };
                    data.push(rowData);
                }
                formattedString = '';
                
                data.forEach(item => {
                    formattedString += `Item: ${item.denominacao}\n`;
                    formattedString += `Unidade: ${item.unidade}\n`;
                    formattedString += `Valor Unitário: ${item.valorUnitario}\n`;
                    formattedString += `Natureza: ${item.natureza}\n`;
                    formattedString += `Elemento de Despesa: ${item.elementoDespesa}\n\n`;
                });
                contratoFinal = contratoFinal.replaceAll(("{{itensDespesa}}"), formattedString);
                
                table = document.getElementById("metasProjeto");
                rows = table.getElementsByTagName('tr');
                data = [];

                // Percorre cada linha da tabela (excluindo o cabeçalho)
                for (let i = 1; i < rows.length; i++) {
                    const cells = rows[i].getElementsByTagName('td');
                    const rowData = {
                        meta: cells[0].getElementsByTagName('input')[0].value,
                        etapa: cells[1].getElementsByTagName('input')[0].value,
                        especificacoes: cells[2].getElementsByTagName('input')[0].value,
                        unid: cells[3].getElementsByTagName('input')[0].value,
                        quant: cells[4].getElementsByTagName('input')[0].value,
                        ini: cells[5].getElementsByTagName('input')[0].value,
                        fim: cells[6].getElementsByTagName('input')[0].value
                    };
                    data.push(rowData);
                }
                let formattedString = '';

                data.forEach(item => {
                    formattedString += `Meta: ${item.meta}\n`;
                    formattedString += `Etapa: ${item.etapa}\n`;
                    formattedString += `Especificações: ${item.especificacoes}\n`;
                    formattedString += `Unid: ${item.unid}\n`;
                    formattedString += `Quant: ${item.quant}\n\n`;
                    formattedString += `Início: ${item.ini}\n\n`;
                    formattedString += `Fim: ${item.fim}\n\n`;
                });
                contratoFinal = contratoFinal.replaceAll(("{{metasProjeto}}"), formattedString);

                var contratoPartes = contratoFinal.split('\r\n\r\n\r\n');
                
                doc.setFont("Helvetica", "bold");
                doc.text(contratoPartes[0], 20, size, { maxWidth: 170 })
                doc.setFont("Helvetica", "normal");
                
                aux = contratoPartes[0];
                linhas = doc.splitTextToSize(aux.replace('\n',''), 170);
                alturaTexto = linhas.length * alturaLinha;
                size += alturaTexto + fatorConversao * fontSize * 2;
                fontSize = 12;
                doc.setFontSize(12)
                contratoPartes.slice(1, contratoPartes.length).forEach((item, index) => {
                    if(item.includes('\r\n\r\n')){
                        var aux2 = item.split('\r\n\r\n');
                        aux2.forEach((item2, index2) =>{
                            if(item2.includes('\r\n')){
                                aux3 = item2.split('\r\n');
                                aux3.forEach((item3, index3)=>{
                                    PrintSplitedText(item3);
                                })
                            }else{
                                if(item2.includes(':')){
                                    PrintSplitedText(item2);
                                }else{
                                    linhas = doc.splitTextToSize(item2.replace('\n',''), 170);
                                    alturaTexto = (linhas.length + 1) * alturaLinha;

                                    if(size + alturaTexto + fatorConversao * fontSize * 2 + 1 * fontSize * 0.15>= 297){
                                        doc.addPage();
                                        size = 20;
                                    }

                                    doc.setFont("Helvetica", "bold");
                                    doc.text("\n" + item2, 20, size, { maxWidth: 170 })

                                    size += alturaTexto + fatorConversao * fontSize * 2 + 1 * fontSize * 0.15;
                                    doc.setFont("Helvetica", "normal");
                                }
                            }   
                        })
                    
                    }
                    else{
                        console.log(item)
                        linhas = doc.splitTextToSize(item.replace('\n',''), 170);
                        alturaTexto = (linhas.length + 1)* alturaLinha;

                        if(size + alturaTexto + fatorConversao * fontSize * 2 + 2 * fontSize * 0.15>= 297){
                            doc.addPage();
                            size = 20;
                        }

                        doc.setFont("Helvetica", "bold");
                        doc.text("\n" + item, 20, size, { maxWidth: 170 })

                        size += alturaTexto + fatorConversao * fontSize * 2 + 2 * fontSize * 0.15;
                        doc.setFont("Helvetica", "normal");
                    }
                })
                const projectTitle = document.getElementById('titulo').value
                doc.save(projectTitle + ".pdf");
                doc = doc = new jsPDF();
            });
            }
    </script>
</body>
</html>
